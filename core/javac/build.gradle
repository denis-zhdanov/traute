import org.gradle.internal.jvm.Jvm

plugins {
    id "com.jfrog.bintray" version '1.7.3'
}

archivesBaseName = 'traute-javac'

dependencies {
    compileOnly files(Jvm.current().toolsJar)
    compileOnly project(':core:common')

    testCompile project(':core:test-common').sourceSets.test.output
    testCompile project(path: ':core:test-common', configuration: 'testCompile')
    testCompile 'org.mockito:mockito-core:2.12.0'
}

jar {
    into('/')
    from { configurations.compileOnly.filter {it.name.contains('common')}.collect { it.isDirectory() ? it : zipTree(it) } }
}

uploadArchives {
    repositories {
        mavenDeployer {
            pom.project {
                name 'Traute Javac Plugin'
                description 'A Javac plugin which inserts null-checks into generated bytecode'
                url 'http://traute.oss.harmonysoft.tech/core/javac/'
            }
        }
    }
}

setupBintray()